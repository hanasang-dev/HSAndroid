#!/bin/sh

echo "🔍 Running Dependency Analysis Check..."
./gradlew buildHealth --quiet
if [ $? -ne 0 ]; then
  echo "❌ Dependency Analysis failed."
  echo "Please review ./build/reports/dependency-analysis/build-health-report.txt"
  exit 1
fi

echo "✅ Dependency Analysis Check passed."

echo "🔍 Running Dependency Updates Check..."
cd "$(git rev-parse --show-toplevel)" || exit 1
./gradlew dependencyUpdates --quiet

git add report.json

echo "✅ Dependency Updates report generated and staged."

exit 0